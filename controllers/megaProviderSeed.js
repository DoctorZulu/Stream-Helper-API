import express, { json } from "express";
import prisma from "@prisma/client";
import movieIDFetch from "./movieIDFetch.js";
import fetch from "node-fetch";

const db = new prisma.PrismaClient({
  log: ["info", "warn"],
  errorFormat: "pretty",
});

const ids = [
  19404,
  278,
  696374,
  724089,
  240,
  652722,
  238,
  1955,
  761053,
  424,
  441130,
  19542,
  372058,
  531428,
  508442,
  791373,
  16672,
  46738,
  490132,
  129,
  389,
  637,
  429,
  537061,
  20532,
  637920,
  110420,
  28978,
  20530,
  500,
  600,
  554596,
  360814,
  397567,
  1092,
  15383,
  947,
  60243,
  1892,
  301,
  8422,
  13,
  11423,
  307,
  14537,
  901,
  290098,
  28,
  399106,
  77,
  475557,
  437068,
  348,
  424694,
  962,
  41050,
  17295,
  414419,
  20453,
  20246,
  497,
  38,
  20914,
  26022,
  510,
  18491,
  10376,
  25237,
  1059,
  439,
  98,
  654299,
  449176,
  552532,
  654,
  3175,
  31411,
  1580,
  316029,
  142061,
  680,
  769,
  598,
  640344,
  807,
  105,
  655,
  406997,
  24382,
  455661,
  832,
  505262,
  205596,
  20941,
  15244,
  3083,
  530915,
  30588,
  149,
  745,
  446159,
  56231,
  594634,
  310569,
  299536,
  572154,
  158445,
  12477,
  120,
  975,
  504253,
  299534,
  5801,
  9702,
  523781,
  614,
  55823,
  55960,
  8587,
  282848,
  122,
  400928,
  476292,
  27205,
  101,
  24188,
  992,
  1124,
  42229,
  426618,
  1396,
  538362,
  641,
  110,
  13223,
  242,
  667520,
  103663,
  4348,
  618344,
  73,
  157336,
  797,
  15,
  103,
  610461,
  489,
  37165,
  11104,
  146233,
  673,
  1091,
  5925,
  644479,
  264644,
  204,
  324857,
  12493,
  335,
  29259,
  237791,
  19,
  9764,
  666,
  339877,
  8392,
  68718,
  160885,
  28178,
  627,
  32085,
  223,
  583083,
  197,
  556574,
  490,
  311,
  378064,
  128,
  207,
  398818,
  521,
  705,
  411088,
  378108,
  843,
  7508,
  488623,
  213,
  522212,
  94047,
  152532,
  25364,
  77338,
  518068,
  284,
  3782,
  567,
  470044,
  422,
  1585,
  14,
  426,
  100,
  11324,
  324786,
  515001,
  961,
  938,
  110416,
  10238,
  3777,
  10515,
  775,
  155,
  11659,
  599,
  244786,
  313106,
  18148,
  19426,
  16869,
  606856,
  857,
  21634,
  458302,
  147,
  12104,
  11778,
  38286,
  12761,
  491480,
  70,
  532067,
  630566,
  447362,
  423,
  432517,
  620683,
  517814,
  185,
  62,
  872,
  638507,
  603,
  522518,
  11712,
  3090,
  106646,
  458220,
  11658,
  150540,
  10098,
  354912,
  10494,
  539,
  1891,
  527641,
  755812,
  527774,
  37257,
  7347,
  568160,
  50014,
  111,
  149871,
  359940,
  12445,
  687,
  387,
  120467,
  346,
  550,
  914,
  274,
  5156,
  635302,
  629,
  28422,
  1422,
  14696,
  334543,
  81481,
  315465,
  29264,
  524,
  242828,
  334533,
  839,
  11216,
  42269,
  399566,
  600354,
  1398,
  11645,
  9277,
  821,
  996,
  548,
  935,
  800,
  406,
  280,
  18438,
  28971,
  7857,
  556901,
  662,
  331482,
  694,
  4935,
  664767,
  3082,
  265177,
  508965,
  2517,
  2457,
  11878,
  289,
  895,
  7345,
  381284,
  140420,
  279,
  25376,
  25538,
  609242,
  369557,
  8290,
  595,
  429210,
  746957,
  1578,
  20803,
  405,
  16,
  671,
  5511,
  47796,
  11656,
  3870,
  113,
  337960,
  596,
  5915,
  13855,
  359784,
  10404,
  10728,
  10242,
  24,
  862,
  430424,
  5544,
  1394,
  656563,
  313369,
  20139,
  24238,
  777,
  805,
  1280,
  49687,
  582927,
  10191,
  359724,
  3112,
  2011,
  564427,
  505192,
  398924,
  20126,
  581,
  32480,
  59440,
  12,
  22683,
  382591,
  587,
  903,
  216,
  431693,
  573699,
  45269,
  579245,
  455714,
  379170,
  33,
  329,
  13398,
  593,
  31011,
  6075,
  200727,
  851,
  2440,
  335578,
  27670,
  503314,
  21135,
  400160,
  45317,
  10997,
  829,
  6977,
  293299,
  10774,
  445030,
  11049,
  235,
  11953,
  1018,
  28162,
  303,
  968,
  14069,
  10775,
  18079,
  57361,
  3034,
  640,
  78,
  29455,
  85,
  1646,
  144,
  93,
  677638,
  25606,
  696,
  142,
  556984,
  263115,
  136,
  262,
  336808,
  16391,
  713776,
  1040,
  273248,
  2640,
  76203,
  21334,
  827,
  9323,
  83564,
  303867,
  27040,
  71157,
  11602,
  10227,
  29845,
  553,
  887,
  707886,
  12444,
  4977,
  963,
  88,
  76,
  20123,
  24167,
  183011,
  1675,
  37797,
  22843,
  265195,
  546554,
  30959,
  613,
  393559,
  15251,
  583,
  49797,
  12491,
  4147,
  833,
  198,
  631,
  10386,
  11036,
  391,
  336804,
  152742,
  16804,
  9479,
  396,
  336,
  10757,
  15916,
  11902,
  277216,
  11621,
  9800,
  234,
  7984,
  118340,
  804,
  31442,
  404378,
  24480,
  352173,
  980,
  25253,
  314365,
  539517,
  317442,
  89,
  575452,
  143,
  33602,
  14160,
  81,
  381341,
  266856,
  275,
  498249,
  33320,
  925,
  81401,
  16859,
  80,
  15265,
  10193,
  2108,
  17483,
  84892,
  702,
  580175,
  371645,
  350,
  10674,
  934,
  679,
  393,
  115,
  453,
  508439,
  13042,
  665,
  61979,
  375794,
  2118,
  86837,
  177572,
  15859,
  374473,
  891,
  15121,
  531,
  363579,
  2721,
  506574,
  949,
  152601,
  435129,
  826,
  234200,
  419478,
  492188,
  29458,
  107,
  508933,
  13929,
  585244,
  126319,
  8327,
  12405,
  11482,
  284427,
  10633,
  653,
  37247,
  286192,
  1402,
  614409,
  122906,
  3078,
  399174,
  47931,
  1626,
  20334,
  502,
  674,
  141,
  554590,
  502033,
  203217,
  499,
  322,
  11697,
  632,
  9475,
  1633,
  981,
  11220,
  194,
  113833,
  11293,
  359156,
  14574,
  451945,
  169813,
  873,
  762,
  585,
  1480,
  43949,
  534780,
  261,
  49026,
  15137,
  23832,
  420814,
  752,
  393729,
  423612,
  597,
  348892,
  22596,
  1908,
  703,
  9421,
  149870,
  166428,
  123025,
  110160,
  3114,
  404,
  513434,
  575604,
  993,
  167581,
  68,
  39356,
  5924,
  210577,
  185789,
  296096,
  323272,
  471707,
  5961,
  596054,
  3763,
  589739,
  380,
  40662,
  525,
  792,
  10229,
  612706,
  205,
  51608,
  990,
  30018,
  11005,
  354857,
  466282,
  14811,
  1607,
  19026,
  615643,
  982,
  11898,
  13187,
  793,
  13363,
  272,
  4480,
  207703,
  13403,
  51828,
  117,
  180147,
  776,
  269149,
  165,
  10315,
  430,
  162,
  96721,
  3309,
  442065,
  1939,
  976,
  198375,
  180299,
  74879,
  11782,
  21575,
  293660,
  16306,
  8703,
  4495,
  6844,
  562,
  4808,
  5528,
  13002,
  24428,
  227932,
  484468,
  544510,
  25468,
  10637,
  55,
  8342,
  218,
  9081,
  3529,
  22504,
  10020,
  14836,
  297222,
  428493,
  995,
  8832,
  675,
  433471,
  13386,
  4347,
  18329,
  19101,
  14282,
  2013,
  13466,
  533444,
  419430,
  1366,
  396535,
  20108,
  164,
  320007,
  9023,
  342470,
  265169,
  25188,
  15794,
  14813,
  4995,
  1567,
  489999,
  309809,
  1933,
  468284,
  26280,
  52345,
  1700,
  845,
  586863,
  16052,
  12429,
  38251,
  269,
  54186,
  286217,
  808,
  333339,
  502897,
  177945,
  221,
  14624,
  364137,
  586940,
  4024,
  40619,
  2062,
  334,
  8416,
  10835,
  12516,
  313297,
  76696,
  1904,
  19223,
  382748,
  14784,
  306819,
  10161,
  483184,
  9394,
  17431,
  71,
  10144,
  137182,
  1417,
  22,
  238628,
  426426,
  347201,
  576,
  522627,
  10754,
  10331,
  8073,
  11474,
  8358,
  9444,
  642,
  900,
  11321,
  3133,
  9912,
  592,
  1075,
  24160,
  11787,
  211954,
  413594,
  42801,
  288,
  1587,
  773,
  244063,
  11113,
  222935,
  1726,
  41411,
  1600,
  18900,
  57158,
  30020,
  2786,
  2649,
  672,
  99,
  221732,
  767,
  678,
  9806,
  11686,
  50531,
  398978,
  283995,
  364111,
  44214,
  746,
  5143,
  638,
  3580,
  4593,
  284053,
  21734,
  5708,
  108,
  1628,
  24657,
  14580,
  9552,
  643,
  28580,
  3009,
  31417,
  520172,
  51739,
  5165,
  16305,
  11040,
  627725,
  10363,
  4291,
  877,
  3558,
  12102,
  2690,
  14756,
  11854,
  309,
  83666,
  12548,
  343,
  1632,
  1859,
  220,
  2493,
  22881,
  10778,
  15014,
  15917,
  63,
  507569,
  658,
  247,
  11299,
  5910,
  16237,
  9343,
  244,
  582014,
  244267,
  9693,
  673595,
  11562,
  277834,
  4481,
  52629,
  546121,
  9340,
  83389,
  338,
  440298,
  4638,
  456929,
  4497,
  82702,
  10322,
  820,
  871,
  594328,
  13413,
  4960,
  31216,
  1913,
  544401,
  2000,
  41498,
  486589,
  61202,
  137,
  4922,
  453278,
  12093,
  1592,
  13562,
  1879,
  11356,
  812,
  11657,
  11046,
  111083,
  581734,
  11421,
  9040,
  433,
  375262,
  308369,
  327331,
  17057,
  11171,
  15371,
  13528,
  529216,
  85350,
  242582,
  910,
  688,
  2433,
  1654,
  578,
  3767,
  1678,
  417261,
  221731,
  375572,
  216156,
  4982,
  14736,
  484751,
  26371,
  3116,
  451480,
  783,
  1372,
  100402,
  1093,
  9377,
  49992,
  64,
  158,
  514754,
  43904,
  301528,
  137113,
  36685,
  413279,
  71859,
  755339,
  863,
  4909,
  348678,
  616,
  140607,
  24653,
  824,
  200481,
  514439,
  11362,
  21832,
  11610,
  2487,
  416144,
  16619,
  12498,
  228205,
  6620,
  3001,
  3035,
  329865,
  315846,
  118406,
  431580,
  375785,
  11969,
  551332,
  229,
  487558,
  339,
  11167,
  819,
  7500,
  37769,
  940,
  747,
  11031,
  4553,
  8740,
  9016,
  10604,
  11528,
  27327,
  346648,
  269258,
  264660,
  283587,
  1712,
  212,
  381289,
  4951,
  782,
  1902,
  1579,
  332562,
  175,
  470878,
  1360,
  923,
  228326,
  1407,
  8681,
  38757,
  11327,
  491418,
  11344,
  483980,
  14283,
  1954,
  2009,
  985,
  10734,
  74308,
  1883,
  489418,
  823,
  527,
  244088,
  252,
  457601,
  246741,
  948,
  451657,
  9289,
  11190,
  7735,
  650,
  14919,
  1786,
  389015,
  5781,
  37903,
  601,
  69,
  7214,
  1023,
  786,
  15919,
  203833,
  11704,
  10437,
  75629,
  379019,
  765,
  64690,
  18333,
  11016,
  503919,
  429617,
  659959,
  522,
  27632,
  12163,
  176241,
  475,
  16328,
  649,
  828,
  583406,
  439584,
  628,
  621013,
  481848,
  12169,
  319,
  11506,
  337703,
  11906,
  13060,
  26596,
  127585,
  32909,
  10110,
  414425,
  983,
  779,
  507505,
  408647,
  19995,
  37719,
  9008,
  2134,
  630,
  109424,
  15472,
  630220,
  18917,
  921,
  4550,
  583689,
  13310,
  613090,
  15097,
  11030,
  484747,
  290,
  33273,
  330459,
  366170,
  194662,
  575,
  13754,
  447332,
  966,
  127533,
  967,
  200085,
  11688,
  63311,
  10683,
  37181,
  11798,
  79,
  11970,
  431937,
  109,
  9428,
  265180,
  519010,
  227306,
  9462,
  17809,
  502425,
  21191,
  590223,
  907,
  483983,
  574,
  334541,
  14257,
  271706,
  4174,
  34106,
  9495,
  10747,
  376290,
  251516,
  36557,
  15165,
  500664,
  16642,
  1051,
  10787,
  260513,
  59436,
  626,
  76341,
  379,
  565310,
  9028,
  532,
  552178,
  11544,
  8094,
  9665,
  11202,
  412656,
  407445,
  340666,
  475888,
  9571,
  10950,
  28874,
  9366,
  529203,
  179144,
  284293,
  22584,
  625,
  138843,
  18,
  11481,
  39324,
  363,
  6916,
  374720,
  9056,
  481432,
  192,
  193756,
  639,
  401306,
  648,
  1544,
  13930,
  571,
  100271,
  11178,
  186,
  3088,
  281957,
  292011,
  8440,
  21450,
  1847,
  11549,
  11471,
  239571,
  190859,
  1677,
  1541,
  369299,
  377273,
  4254,
  984,
  11841,
  226,
  9549,
  382614,
  11829,
  10843,
  704,
  1949,
  530,
  11545,
  345,
  1391,
  1813,
  15764,
  406385,
  11159,
  437586,
  58451,
  446893,
  364433,
  228150,
  881,
  10784,
  274109,
  47735,
  211387,
  3933,
  9504,
  1554,
  433498,
  140,
  13635,
  284054,
  535356,
  10911,
  75233,
  451915,
  16958,
  13980,
  9516,
  451499,
  1251,
  508570,
  31522,
  9559,
  1523,
  11615,
  9385,
  9509,
  137106,
  3110,
  3063,
  88273,
  491584,
  319373,
  94329,
  552095,
  49361,
  487670,
  13151,
  132344,
  217993,
  8321,
  428836,
  273895,
  11349,
  9918,
  256040,
  25403,
  22538,
  13377,
  13321,
  13475,
  2291,
  2757,
  5503,
  157354,
  434616,
  383498,
  595975,
  38396,
  13384,
  856,
  18988,
  258480,
  43920,
  466272,
  10377,
  13446,
  176983,
  10400,
  33997,
  16858,
  14645,
  34647,
  219,
  499631,
  13353,
  11901,
  10907,
  7549,
  38234,
  12207,
  10849,
  388,
  7452,
  114,
  26638,
  8356,
  11948,
  1669,
  290762,
  31767,
  145,
  387426,
  454626,
  10549,
  516486,
  560050,
  417320,
  37472,
  6114,
  463257,
  4133,
  522369,
  492,
  16234,
  10794,
  284052,
  345938,
  794,
  165213,
  416477,
  489930,
  127501,
  9075,
  129670,
  568,
  10435,
  74643,
  620,
  1368,
  2639,
  6003,
  13689,
  40794,
  153,
  271674,
  28055,
  312221,
  353081,
  512895,
  273481,
  335984,
  76758,
  4584,
  4689,
  8333,
  154,
  9461,
  610120,
  118412,
  545609,
  376867,
  15600,
  25623,
  440596,
  615,
  15774,
  176,
  802,
  37775,
  686,
  420809,
  106,
  497582,
  76589,
  290542,
  5723,
  3766,
  14092,
  458156,
  621,
  271110,
  11661,
  8810,
  260,
  3085,
  2759,
  37135,
  853,
  304357,
  458131,
  111969,
  38985,
  339403,
  250219,
  39323,
  380225,
  17529,
  2292,
  8055,
  72478,
  11206,
  394117,
  15999,
  64682,
  2898,
  302528,
  339984,
  2503,
  90369,
  840,
  432616,
  1052,
  65218,
  4203,
  16372,
  2034,
  2798,
  24226,
  12837,
  474395,
  49020,
  1594,
  16320,
  462,
  7249,
  239877,
  228203,
  15362,
  75656,
  39107,
  16646,
  713,
  293863,
  16633,
  206487,
  2056,
  550231,
  1653,
  395834,
  9299,
  3109,
  315635,
  12776,
  381,
  547258,
  87827,
  307081,
  10086,
  303483,
  8741,
  6404,
  377263,
  433247,
  2501,
  187,
  7863,
  427,
  4476,
  1245,
  11368,
  9361,
  429174,
  814,
  11881,
  504608,
  7862,
  5123,
  146,
  10024,
  429450,
  763,
  902,
  196,
  255,
  11416,
  249164,
  161,
  690,
  760,
  488,
  342737,
  498248,
  30061,
  21484,
  425373,
  339380,
  19666,
  10234,
  289222,
  212167,
  874,
  26963,
  1542,
  205220,
  756,
  9662,
  1429,
  2252,
  25866,
  614696,
  11978,
  140823,
  197082,
  245913,
  18925,
  801,
  259316,
  403450,
  132363,
  101299,
  31682,
  19100,
  5967,
  71883,
  11589,
  72213,
  121986,
  14433,
  19067,
  17654,
  2899,
  6644,
  618354,
  496243,
  592350,
  40096,
  582,
  522924,
  92321,
  121,
  26451,
  670,
  599521,
  11,
  239,
  92060,
  780,
  10681,
  770,
  48035,
  11010,
  20271,
  20722,
  298582,
  9652,
  965,
  356296,
  407448,
  13008,
  14638,
  15359,
  25793,
  613504,
  11072,
  11537,
  9603,
  1491,
  10360,
  220289,
  13597,
  58,
  11020,
  3089,
  4543,
  81188,
  38142,
  330457,
  10669,
  318781,
  7913,
  11426,
  16563,
  20312,
  10705,
  18785,
  379291,
  14202,
  11773,
  51241,
  399055,
  2576,
  509,
  10511,
  634544,
  4011,
  1116,
  25673,
  499932,
  470,
  17159,
  6949,
  14554,
  318846,
  180,
  2977,
  73624,
  191714,
  837,
  57212,
  375315,
  10722,
  537056,
  109445,
  22164,
  436343,
  399404,
  65754,
  11197,
  457,
  10518,
  4032,
  11101,
  79120,
  13932,
  594,
  99861,
  38528,
  1427,
  922,
  21032,
  58857,
  11663,
  13004,
  284689,
  587792,
  39486,
  54138,
  245891,
  121875,
  549053,
  830,
  4771,
  1645,
  476968,
  13183,
  459,
  11986,
  759,
  168259,
  395991,
  76543,
  242643,
  15152,
  184,
  9550,
  9426,
  169881,
  10474,
  1433,
  259761,
  37799,
  10112,
  122917,
  9587,
  403,
  45612,
  519035,
  1598,
  18320,
  323677,
  2270,
  892,
  14163,
  121642,
  587807,
  581528,
  36940,
  771,
  283591,
  26842,
  2841,
  15003,
  850,
  408220,
  167073,
  2756,
  475215,
  9609,
  8337,
  11963,
  73456,
  46838,
  250538,
  16307,
  22803,
  435577,
  4816,
  13382,
  205587,
  500006,
  82690,
  10860,
  15080,
  209274,
  9454,
  244403,
  18947,
  855,
  1895,
  23550,
  50848,
  987,
  476299,
  11943,
  10312,
  11230,
  3121,
  5590,
  475946,
  15384,
  9474,
  859,
  9325,
  420622,
  61791,
  10994,
  11951,
  364689,
  6619,
  519141,
  506528,
  9539,
  407449,
  37094,
  43641,
  11236,
  64956,
  618355,
  400090,
  65229,
  3543,
  12622,
  11577,
  6145,
  87,
  12481,
  11044,
  417678,
  9400,
  10654,
  1359,
  454983,
  80278,
  114150,
  9267,
  152603,
  20620,
  381288,
  3176,
  77016,
  245168,
  119450,
  766,
  396263,
  10886,
  340,
  198277,
  1278,
  35690,
  10693,
  12140,
  360606,
  1791,
  392982,
  14438,
  11499,
  8056,
  134,
  152780,
  70670,
  69735,
  14534,
  112198,
  49051,
  329819,
  547016,
  13933,
  8374,
  15196,
  19913,
  34653,
  2666,
  590,
  672647,
  11713,
  30497,
  385103,
  318121,
  3131,
  1716,
  10440,
  227,
  515916,
  10647,
  11330,
  661914,
  11673,
  12162,
  45958,
  33701,
  36040,
  9470,
  764,
  306745,
  8424,
  166666,
  5506,
  53457,
  577922,
  778730,
  13041,
  377,
  10867,
  520736,
  6037,
  451,
  68734,
  104,
  11644,
  7979,
  53565,
  21348,
  374461,
  293670,
  866,
  338766,
  16085,
  391713,
  10795,
  1640,
  297762,
  2654,
  1830,
  317557,
  5825,
  15601,
  479226,
  508642,
  15370,
  177,
  10975,
  18311,
  49538,
  9833,
  436,
  21641,
  16520,
  14047,
  5548,
  323661,
  1672,
  205601,
  41201,
  1254,
  40823,
  400617,
  17814,
  246,
  12900,
  345920,
  1725,
  19908,
  15255,
  51497,
  11850,
  6978,
  346364,
  11109,
  67884,
  512263,
  265712,
  1850,
  813,
  199,
  44716,
  296098,
  12105,
  988,
  250480,
  179150,
  25846,
  1265,
  50646,
  266,
  504,
  8923,
  595671,
  10149,
  11868,
  401104,
  1262,
  30197,
  612368,
  695,
  2771,
  9078,
  449924,
  338189,
  979,
  113082,
  524047,
  2609,
  259693,
  2657,
  393624,
  112949,
  623,
  14447,
  80184,
  8393,
  8844,
  486947,
  1088,
  350312,
  109689,
  38700,
  1878,
  861,
  59421,
  26617,
  93289,
  10009,
  19236,
  941,
  489925,
  321528,
  7340,
  404368,
  506,
  10501,
  11502,
  360365,
  469,
  465136,
  6396,
  536743,
  8088,
  2277,
  844,
  6537,
  82695,
  116,
  1923,
  11305,
  11450,
  10139,
  11816,
  12762,
  425,
  10452,
  9589,
  129112,
  228194,
  2502,
  44264,
  11886,
  4232,
];

const megaProviderSeed = () => {
  let urls = [];

  const urlArray = () => {
    for (let i = 1; i < 10; i++) {
      urls.push(
        `https://api.themoviedb.org/3/movie/${ids[i]}/watch/providers?api_key=999a045dba2d80d839d8ed4db5942fae`
      );
    }
  };
  urlArray();
  let promises = urls.map((url) => fetch(url).then((res) => res.json()));

  Promise.all(promises).then((json) => {
    let deconstructed = [];
    let fullData = [];
    let newMergedData;

    for (let i = 0; i < 9; i++) {
      deconstructed.push(json[i].results.US);
    }

    fullData.push(deconstructed);

    newMergedData = [].concat.apply([], fullData);
    console.log(newMergedData);

    let index = -1;
    newMergedData.forEach((movie) => {
      index++;
      console.log(ids[index]);
      const mainAddMovie = async () => {
        let newMovie = await db.watchProvider.upsert({
          create: {
            movieId: ids[index],
            providers: movie,
          },
          update: {},
          where: {
            id: index,
          },
        });

        return newMovie;
      };
      mainAddMovie();
    });
  });
};

export default megaProviderSeed;
